<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>An example with a heavy vector and a heavy fermion &#8212; efttools  documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="an-example-with-a-heavy-vector-and-a-heavy-fermion">
<h1>An example with a heavy vector and a heavy fermion<a class="headerlink" href="#an-example-with-a-heavy-vector-and-a-heavy-fermion" title="Permalink to this headline">¶</a></h1>
<p>Here we will illustrate more features of the library as the use of covariant derivatives, or the management of Lorentz and flavor indices.</p>
<p>The model will now be the Standard Model coupled to a family of color-singlet vector <span class="math">\(\mathcal{L}^i_\mu\)</span> with representation <span class="math">\(2_{1/2}\)</span> under <span class="math">\(SU(2)\times U(1)\)</span> and another family of vector-like leptons <span class="math">\(E^i\)</span> with the same representation as the right-handed electron <span class="math">\(e_R\)</span> of the Standard Model. The interaction lagrangian will be:</p>
<div class="math">
\[ \begin{align}\begin{aligned}\mathcal{L}_{int} =
    - \gamma_i \mathcal{L}_\mu^{\dagger i} D^\mu \phi
    - \gamma_i (D^\mu\phi)^\dagger\mathcal{L}^i_\mu
    - (\lambda^E_l)_{ij} \bar{E}^i_R \phi^\dagger l^j_L\\    - (\lambda^E_l)^*_{ij} \bar{l}^j_L \phi E^i_R
    - z^E_{ijk} \bar{E}^i_{L} \mathcal{L}^{j\dagger}_\mu \gamma^\mu l^k_L
    - z^{E*}_{ijk} \bar{l}^k_{L} \mathcal{L}^j_\mu \gamma^\mu E^i_L\end{aligned}\end{align} \]</div>
<div class="section" id="creation-of-the-model">
<h2>Creation of the model<a class="headerlink" href="#creation-of-the-model" title="Permalink to this headline">¶</a></h2>
<p>As before, we first create the tensors:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">gamma</span> <span class="o">=</span> <span class="n">TensorBuilder</span><span class="p">(</span><span class="s2">&quot;gamma&quot;</span><span class="p">)</span>
<span class="n">gammac</span> <span class="o">=</span> <span class="n">TensorBuilder</span><span class="p">(</span><span class="s2">&quot;gammac&quot;</span><span class="p">)</span>

<span class="n">lambdaEl</span> <span class="o">=</span> <span class="n">TensorBuilder</span><span class="p">(</span><span class="s2">&quot;lambdaElc&quot;</span><span class="p">)</span>
<span class="n">lambdaElc</span> <span class="o">=</span> <span class="n">TensorBuilder</span><span class="p">(</span><span class="s2">&quot;lambdaElc&quot;</span><span class="p">)</span>

<span class="n">zE</span> <span class="o">=</span> <span class="n">TensorBuilder</span><span class="p">(</span><span class="s2">&quot;zE&quot;</span><span class="p">)</span>
<span class="n">zEc</span> <span class="o">=</span> <span class="n">TensorBuilder</span><span class="p">(</span><span class="s2">&quot;zEc&quot;</span><span class="p">)</span>

<span class="n">sigmaSU2</span> <span class="o">=</span> <span class="n">TensorBuilder</span><span class="p">(</span><span class="s2">&quot;sigmaSU2&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>and the fields:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">phi</span> <span class="o">=</span> <span class="n">TensorBuilder</span><span class="p">(</span><span class="s2">&quot;phi&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">boson</span><span class="p">)</span>
<span class="n">phic</span> <span class="o">=</span> <span class="n">TensorBuilder</span><span class="p">(</span><span class="s2">&quot;phic&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">boson</span><span class="p">)</span>

<span class="n">lL</span> <span class="o">=</span> <span class="n">TensorBuilder</span><span class="p">(</span><span class="s2">&quot;lL&quot;</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">fermion</span><span class="p">)</span>
<span class="n">lLc</span> <span class="o">=</span> <span class="n">TensorBuilder</span><span class="p">(</span><span class="s2">&quot;lLc&quot;</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">fermion</span><span class="p">)</span>

<span class="n">L</span> <span class="o">=</span> <span class="n">TensorBuilder</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">boson</span><span class="p">)</span>
<span class="n">Lc</span> <span class="o">=</span> <span class="n">TensorBuilder</span><span class="p">(</span><span class="s2">&quot;Lc&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">boson</span><span class="p">)</span>

<span class="n">EL</span> <span class="o">=</span> <span class="n">TensorBuilder</span><span class="p">(</span><span class="s2">&quot;EL&quot;</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">fermion</span><span class="p">)</span>
<span class="n">ER</span> <span class="o">=</span> <span class="n">TensorBuilder</span><span class="p">(</span><span class="s2">&quot;ER&quot;</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">fermion</span><span class="p">)</span>
<span class="n">ELc</span> <span class="o">=</span> <span class="n">TensorBuilder</span><span class="p">(</span><span class="s2">&quot;ELc&quot;</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">fermion</span><span class="p">)</span>
<span class="n">ERc</span> <span class="o">=</span> <span class="n">TensorBuilder</span><span class="p">(</span><span class="s2">&quot;ERc&quot;</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">fermion</span><span class="p">)</span>
</pre></div>
</div>
<p>For every two-component spinor we need to define two fields: one is the conjugate of the other. Therefore, a Dirac spinor requires four <code class="docutils literal"><span class="pre">FieldBuider</span></code> definitions. The integration part of the library is prepared to deal with spinor in two-component formalism. The tensor builders <code class="docutils literal"><span class="pre">epsUp</span></code>, <code class="docutils literal"><span class="pre">epsUpDot</span></code>, <code class="docutils literal"><span class="pre">epsDown</span></code>, <code class="docutils literal"><span class="pre">epsDownDot</span></code>, <code class="docutils literal"><span class="pre">sigma4</span></code> and <code class="docutils literal"><span class="pre">sigma4bar</span></code>, corresponding to the tensors <span class="math">\(\epsilon^{\alpha\beta}\)</span>, <span class="math">\(\epsilon^{\dot{\alpha}\dot{\beta}}\)</span>, <span class="math">\(\epsilon_{\alpha\beta}\)</span>, <span class="math">\(\epsilon_{\dot{\alpha}\dot{\beta}}\)</span>, <span class="math">\(\sigma^\mu_{\alpha\dot{\beta}}\)</span> and <span class="math">\(\sigma_\mu^{\dot{\alpha}\beta}$\)</span> are already defined in the library.</p>
<p>The next step now is defining the lagrangian. To introduce covariant derivatives of a tensor, the function <code class="docutils literal"><span class="pre">D</span></code> should be used. Its first argument is its Lorenz index and the second is the tensor for which the derivative is to be taken:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">interaction_lagrangian</span> <span class="o">=</span> <span class="o">-</span><span class="n">OpSum</span><span class="p">(</span>
    <span class="n">Op</span><span class="p">(</span><span class="n">gamma</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Lc</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">D</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">phi</span><span class="p">(</span><span class="mi">2</span><span class="p">))),</span>
    <span class="n">Op</span><span class="p">(</span><span class="n">gammac</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">D</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">phic</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="n">L</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>

    <span class="n">Op</span><span class="p">(</span><span class="n">lambdaEl</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ERc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">phic</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">lL</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span>
    <span class="n">Op</span><span class="p">(</span><span class="n">lambdaElc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">lLc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">phi</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">ER</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>

    <span class="n">Op</span><span class="p">(</span><span class="n">zE</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">ELc</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">Lc</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
       <span class="n">sigma4bar</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">lL</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span>
    <span class="n">Op</span><span class="p">(</span><span class="n">zEc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">lLc</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">L</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
       <span class="n">sigma4bar</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">EL</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="section" id="integration">
<h2>Integration<a class="headerlink" href="#integration" title="Permalink to this headline">¶</a></h2>
<p>The heavy fields are:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">heavy_L</span> <span class="o">=</span> <span class="n">ComplexVector</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">,</span> <span class="s2">&quot;Lc&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">heavy_E</span> <span class="o">=</span> <span class="n">VectorLikeFermion</span><span class="p">(</span><span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;EL&quot;</span><span class="p">,</span> <span class="s2">&quot;ER&quot;</span><span class="p">,</span> <span class="s2">&quot;ELc&quot;</span><span class="p">,</span> <span class="s2">&quot;ERc&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">heavy_fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">heavy_L</span><span class="p">,</span> <span class="n">heavy_E</span><span class="p">]</span>
</pre></div>
</div>
<p>The first argument to the constructors of the real boson classes is the name of the corresponding field and the second argument is the number of indices this field carries. For the complex boson and Majorana fermion cases the first two arguments correspond, respectively, to the field and its conjugate, whereas the third one is the number of indices. For vector-like fermions, the args are, in order: the name of the fermion, the names of the fields representing its left-handed, right-handed, conjugate left-handed and conjugate right-handed parts, and the number of indices.</p>
<p>To integrate them out to get an effective lagrangian with operators up to dimension 6, we do:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">effective_lagrangian</span> <span class="o">=</span> <span class="n">integrate</span><span class="p">(</span><span class="n">heavy_fields</span><span class="p">,</span> <span class="n">interaction_lagrangian</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="transformations-of-the-effective-lagrangian">
<h2>Transformations of the effective lagrangian<a class="headerlink" href="#transformations-of-the-effective-lagrangian" title="Permalink to this headline">¶</a></h2>
<p>Let&#8217;s say we are interested in the mixed contribution of <span class="math">\(L_\mu\)</span> and <span class="math">\(E\)</span>. We can collect the corresponding terms using the fact that they will contain the masses of both heavy fields. The masses are automatically given the name <code class="docutils literal"><span class="pre">&quot;M{name}&quot;</span></code> where <code class="docutils literal"><span class="pre">{name}</span></code> is the name of the field:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mixed_eff_lag</span> <span class="o">=</span> <span class="n">OpSum</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">op</span> <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">mixed_eff_lag</span><span class="o">.</span><span class="n">operators</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">contains_symbol</span><span class="p">(</span><span class="s2">&quot;ML&quot;</span><span class="p">)</span> <span class="ow">and</span>
                            <span class="n">op</span><span class="o">.</span><span class="n">contains_symbol</span><span class="p">(</span><span class="s2">&quot;ME&quot;</span><span class="p">))])</span>
</pre></div>
</div>
<p>The function <code class="docutils literal"><span class="pre">Operator.contains</span></code> checks whether the tensor name passed to it appears in the operator. Masses are represented by a special kind of tensor, a symbol. They are identified by their name beginning with <code class="docutils literal"><span class="pre">&quot;{&quot;</span></code>, ending with <code class="docutils literal"><span class="pre">&quot;}&quot;</span></code> and containing one <code class="docutils literal"><span class="pre">&quot;^&quot;</span></code>. This identifiers are used to tell the library to treat this tensor as some power of a constant and collect and multiply its ocurrences inside an operator. The equivalent to <code class="docutils literal"><span class="pre">Operator.contains</span></code> for symbols is <code class="docutils literal"><span class="pre">Operator.contains_symbol</span></code>, which we have used above.</p>
<p>The operators corresponding to the mixed contributiones that appear after integration are <span class="math">\((\bar{l}^i_L \gamma^\mu D_\mu\phi)(\phi^\dagger l^j_L)\)</span> and it conjugate. Suppose that we want to write the final result in terms of the operators`</p>
<div class="math">
\[\left(\mathcal{O}^{(1)}_{\phi l}\right)_{ij} =
\bar{l}^i_L \gamma^\mu l^j_L \phi^\dagger D_\mu \phi;
\;\;\;\;\;\;
\left(\mathcal{O}^{(3)}_{\phi l}\right)_{ij} =
(\bar{l}^i_L \sigma^a \gamma^\mu l^j_L)
(\phi^\dagger \sigma^a D_\mu \phi);\]</div>
<p>and their complex conjugates. We would then use the identity</p>
<div class="math">
\[(\bar{l}^i_L \gamma^\mu D_\mu\phi)(\phi^\dagger l^j_L) =
\frac{1}{2}\left(
\bar{l}^i_L \gamma^\mu l^j_L \phi^\dagger D_\mu \phi
+(\bar{l}^i_L \sigma^a \gamma^\mu l^j_L)
(\phi^\dagger \sigma^a D_\mu \phi)\right)\]</div>
<p>We can substitute everything that matches the left-hand side by the right-hand side and the conjugate of the LHS by the conjugate of the RHS using the rules:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">rules</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="c1"># Pattern</span>
     <span class="n">Op</span><span class="p">(</span><span class="n">lLc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">sigma4bar</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">D</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">phi</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span>
        <span class="n">phic</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">lL</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)),</span>

     <span class="c1"># Replacement</span>
     <span class="n">OpSum</span><span class="p">(</span><span class="n">number_op</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="n">Op</span><span class="p">(</span><span class="n">lLc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">sigma4bar</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
                               <span class="n">lL</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span> <span class="n">phic</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">D</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">phi</span><span class="p">(</span><span class="mi">4</span><span class="p">))),</span>
           <span class="n">number_op</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="n">Op</span><span class="p">(</span><span class="n">lLc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">sigmaSU2</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
                               <span class="n">sigma4bar</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">lL</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span>
                               <span class="n">phic</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">sigmaSU2</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
                               <span class="n">D</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">phi</span><span class="p">(</span><span class="mi">8</span><span class="p">))))),</span>

    <span class="p">(</span><span class="c1"># Pattern</span>
     <span class="n">Op</span><span class="p">(</span><span class="n">lLc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">sigma4bar</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">phi</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
        <span class="n">D</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">phic</span><span class="p">(</span><span class="mi">4</span><span class="p">)),</span> <span class="n">lL</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)),</span>

     <span class="c1"># Replacement</span>
     <span class="n">OpSum</span><span class="p">(</span><span class="n">number_op</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="n">Op</span><span class="p">(</span><span class="n">lLc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">sigma4bar</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
                               <span class="n">lL</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span> <span class="n">D</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">phic</span><span class="p">(</span><span class="mi">4</span><span class="p">)),</span> <span class="n">phi</span><span class="p">(</span><span class="mi">4</span><span class="p">)),</span>
           <span class="n">number_op</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="n">Op</span><span class="p">(</span><span class="n">lLc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">sigmaSU2</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
                               <span class="n">sigma4bar</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">lL</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span>
                               <span class="n">D</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">phic</span><span class="p">(</span><span class="mi">7</span><span class="p">)),</span> <span class="n">sigmaSU2</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
                               <span class="n">phi</span><span class="p">(</span><span class="mi">8</span><span class="p">))))]</span>
</pre></div>
</div>
<p>We now have to define the basis of operators in which we want the final lagrangian written. We use the function <code class="docutils literal"><span class="pre">flavor_op</span></code> to create a callable such that, when called with several arguments, it returns an operator with a single tensor whose indices are the arguments given:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">O1phil</span> <span class="o">=</span> <span class="n">flavor_op</span><span class="p">(</span><span class="s2">&quot;O1phil&quot;</span><span class="p">)</span>
<span class="n">O1philc</span> <span class="o">=</span> <span class="n">flavor_op</span><span class="p">(</span><span class="s2">&quot;O1philc&quot;</span><span class="p">)</span>
<span class="n">O3phil</span> <span class="o">=</span> <span class="n">flavor_op</span><span class="p">(</span><span class="s2">&quot;O3phil&quot;</span><span class="p">)</span>
<span class="n">O3philc</span> <span class="o">=</span> <span class="n">flavor_op</span><span class="p">(</span><span class="s2">&quot;O3philc&quot;</span><span class="p">)</span>

<span class="n">definition_rules</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="n">Op</span><span class="p">(</span><span class="n">lLc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">sigma4bar</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
        <span class="n">lL</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span> <span class="n">phic</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">D</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">phi</span><span class="p">(</span><span class="mi">4</span><span class="p">))),</span>
     <span class="n">OpSum</span><span class="p">(</span><span class="n">O1phil</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">))),</span>

    <span class="p">(</span><span class="n">Op</span><span class="p">(</span><span class="n">lLc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">sigma4bar</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
        <span class="n">lL</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span> <span class="n">D</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">phic</span><span class="p">(</span><span class="mi">4</span><span class="p">)),</span> <span class="n">phi</span><span class="p">(</span><span class="mi">4</span><span class="p">)),</span>
     <span class="n">OpSum</span><span class="p">(</span><span class="n">O1philc</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">))),</span>

    <span class="p">(</span><span class="n">Op</span><span class="p">(</span><span class="n">lLc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">sigmaSU2</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
        <span class="n">sigma4bar</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">lL</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span>
        <span class="n">phic</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">sigmaSU2</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">D</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">phi</span><span class="p">(</span><span class="mi">8</span><span class="p">))),</span>
     <span class="n">OpSum</span><span class="p">(</span><span class="n">O3phil</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">))),</span>

    <span class="p">(</span><span class="n">Op</span><span class="p">(</span><span class="n">lLc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">sigmaSU2</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
        <span class="n">sigma4bar</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">lL</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span>
        <span class="n">D</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">phic</span><span class="p">(</span><span class="mi">7</span><span class="p">)),</span> <span class="n">sigmaSU2</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">phi</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
     <span class="n">OpSum</span><span class="p">(</span><span class="n">O3philc</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)))]</span>
</pre></div>
</div>
<p>Finally, we just call <code class="docutils literal"><span class="pre">apply_rules_until</span></code> to move the operators the desired base:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">all_rules</span> <span class="o">=</span> <span class="n">rules</span> <span class="o">+</span> <span class="n">definition_rules</span>
<span class="n">final_op_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;O1phil&quot;</span><span class="p">,</span> <span class="s2">&quot;O1philc&quot;</span><span class="p">,</span> <span class="s2">&quot;O3phil&quot;</span><span class="p">,</span> <span class="s2">&quot;O3philc&quot;</span><span class="p">]</span>
<span class="n">transf_eff_lag</span> <span class="o">=</span> <span class="n">apply_rules_until</span><span class="p">(</span>
    <span class="n">effective_lagrangian</span><span class="p">,</span> <span class="n">all_rules</span><span class="p">,</span> <span class="n">final_op_names</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="output">
<h2>Output<a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h2>
<p>We can do as in the previous example to write a text file with the results:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">eff_lag_writer</span> <span class="o">=</span> <span class="n">Writer</span><span class="p">(</span><span class="n">trasnf_eff_lag</span><span class="p">,</span> <span class="n">final_op_names</span><span class="p">)</span>
<span class="n">eff_lag_writer</span><span class="o">.</span><span class="n">write_text_file</span><span class="p">(</span><span class="s2">&quot;L_E_example&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now let&#8217;s specify the LaTeX representation. When there&#8217;s indices in the tensors we should give the positions where they should appear by using the <code class="docutils literal"><span class="pre">str.format</span></code> -style <code class="docutils literal"><span class="pre">&quot;{}&quot;</span></code> placeholders:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">latex_tensor_reps</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;gamma&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\gamma_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="s2">&quot;gammac&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\gamma^*_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="s2">&quot;lambdaEl&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;(\lambda^E_l)_{{</span><span class="si">{}{}</span><span class="s2">}}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;lambdaElc&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;(\lambda^E_l)^*_{{</span><span class="si">{}{}</span><span class="s2">}}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;zE&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;z^E_{{</span><span class="si">{}{}{}</span><span class="s2">}}&quot;</span>
    <span class="s2">&quot;zEc&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;z^{{E*}}_{{</span><span class="si">{}{}{}</span><span class="s2">}}&quot;</span><span class="p">}</span>

<span class="n">latex_op_reps</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;O1phil&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;(\mathcal{{O}}^{{(1)}}_{{\phi l}})_{{</span><span class="si">{}{}</span><span class="s2">}}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;O1philc&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;(\mathcal{{O}}^{{(1)}}^*_{{\phi l}})_{{</span><span class="si">{}{}</span><span class="s2">}}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;O3phil&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;(\mathcal{{O}}^{{(3)}}_{{\phi l}})_{{</span><span class="si">{}{}</span><span class="s2">}}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;O3philc&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;(\mathcal{{O}}^{{(3)}}^*_{{\phi l}})_{{</span><span class="si">{}{}</span><span class="s2">}}&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>Then we are ready to show the pdf:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">latex_indices</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;i&quot;</span><span class="p">,</span> <span class="s2">&quot;j&quot;</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="s2">&quot;n&quot;</span><span class="p">]</span>
<span class="n">eff_lag_writer</span><span class="o">.</span><span class="n">show_pdf</span><span class="p">(</span>
    <span class="s2">&quot;L_E_example&quot;</span><span class="p">,</span> <span class="n">pdf_viewer</span><span class="p">,</span> <span class="n">latex_tensor_reps</span><span class="p">,</span>
    <span class="n">latex_op_reps</span><span class="p">,</span> <span class="n">latex_indices</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">An example with a heavy vector and a heavy fermion</a><ul>
<li><a class="reference internal" href="#creation-of-the-model">Creation of the model</a></li>
<li><a class="reference internal" href="#integration">Integration</a></li>
<li><a class="reference internal" href="#transformations-of-the-effective-lagrangian">Transformations of the effective lagrangian</a></li>
<li><a class="reference internal" href="#output">Output</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/hard_example.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Juan Carlos Criado Alamo.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.5.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/hard_example.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>